#redis

### 项目中常用场景
+ 热点数据的缓存  
redis访问速度块、支持的数据类型比较丰富，一般结合expire进行缓存更新操作，几乎所有的项目都有用到，做缓存机制。

+ 一些限时业务  
1. redis中可以使用expire命令设置一个键的生存时间，到时间后redis会删除它。手机验证码等业务场景。

+ 计次器
redis由于incr命令可以实现原子性的递增，一个接口一分钟限制多少请求、一个接口一天限制调用多少次等等。

+ 分布式锁
setnx命令进行 expire 或者  set 传参['nx', 'ex' => 600];

+ 延时操作
很常见的就有X分钟内未付款就自动取消订单等，Redis Zset 通过時間戳作为socre。 

+ 队列  
异步消费队列，这种也最多了，消费轨迹等，生产者可以有多个地方，消费者只有一个地方，而且我们可以自己控制消费速度。 

### redis 和 memcache 的区别
1、存储方式：
memcache 把数据全部存在内存之中，断电后会挂掉，数据不能超过内存大小   
redis持久化机制，可以备份到磁盘上，保证数据安全   2、数据支持类型：   
redis在数据支持上要比memcache多的多。   
3、因为redis有持久化机制，所以可靠性更强  
4、memcache仅适用于做一些不要求数据安全的缓存机制。  
5、大小支持  

 

Redis的几种架构模式
###1：单机版
1、内存容量有限 2、处理能力有限 3、无法高可用。

###2：主从复制  
介绍：
1：Redis 的复制功能允许用户根据一个 Redis 服务器来创建任意多个该服务器的复制品，
2：其中被复制的服务器为主服务器（master），而通过复制创建出来的服务器复制品则为从服务器（slave）。 
3：只要主从服务器之间的网络连接正常，主从服务器两者会具有相同的数据，主服务器就会一直将发生在自己身上的数据更新同步 给从服务器，从而一直保证主从服务器的数据相同。

####优点:
1、master/slave 角色
2、master/slave 数据相同
3、降低 master 读压力在转交从库
####缺点: 类似于数据库读写分离
1：无法保证高可用
2：没有解决 master 写的压力 
3：数据复制的延迟（业务忽略，选择性读主）
4：读到过期的数据

###3：哨兵模式
哨兵模式是一种特殊的模式，首先Redis提供了哨兵的命令，哨兵是一个独立的进程。
其原理是哨兵通过发送命令，等待Redis服务器响应，从而监控运行的多个Redis实例。

监控 redis 主从服务器，并在主服务器下线时自动进行故障转移。其中三个特性：
1：监控： Sentinel 会不断地检查你的主服务器和从服务器是否运作正常。
2：提醒： 当被监控的某个 Redis 服务器出现问题时， 可以通过 API 向管理员或者其他应用程序发送通知。
3：自动故障迁移：当一个主服务器不能正常工作时，会开始一次自动故障迁移操作。

####优点:
1：保证高可用
2：监控各个节点
3：自动故障迁移
####缺点：
1：主从模式，切换需要时间丢数据
2：没有解决 master 写的压力

###4：集群
没做过详细的了解，分布式存储，增加服务器的数量。多个redis多个节点之间相互配合，增强独写能力。
优点：高可用，解决了master写的压力。
缺点：不了解，成本代价大我觉得。 


