###mysql 优化
设计层面：  
1：查询缓存，有效缓存可以很大幅度减少 db 压力  
2：将列设置为NOT NULL. 原因：null占用存储空间，而且不参与索引树的构建，之前看书上说好像是做了特殊处理标记。  
3：对整数类型指定宽度没有用，如果标识状态码改使用长度较小的TINYINT存储范围是-128 ~ 127，而UNSIGNED TINYINT存储的范围却是0 - 255。  
4:  没有太大的必要使用DECIMAL数据类型。即使是在需要存储财务数据时，仍然可以使用BIGINT。比如需要精确到万分之一，那么可以将数据乘以一百万然后使用BIGINT存储。这样可以避免浮点数计算不准确和DECIMAL精确计算代价高的问题。  
5：TIMESTAMP使用4个字节存储空间，DATETIME使用8个字节存储空间。但是TIMESTAMP只能表示到2038年而且TIMESTAMP的值因时区不同而不同。  
6：枚举类型无必要，必须使用ALTER TABLE（如果只是在列表末尾追加元素，不需要重建表）。  
7：大表ALTER TABLE非常耗时，MySQL执行大部分修改表结果操作的方法是用新的结构创建一个张空表，从旧表中查出所有的数据插入新表，然后再删除旧表。尤其当内存不足而表又很大，而且还有很大索引的情况下，耗时更久。当然有一些奇技淫巧可以解决这个问题，有兴趣可自行查阅。  
8：schema的列不要太多。一个是占用空间大，再一个原因是列太多而实际使用少的话，可能会导致CPU占用过高，存储引擎的API工作时需要在服务器层和存储引擎层之间通过行缓冲格式拷贝数据，然后在服务器层将缓冲内容解码成各个列，这个转换过程的代价是非常高的。  
9： varchar/nvarchar 代替 char/nchar。因为变长字段存储空间小，节省存储空间，其次对于查询来说，在一个相对较小的字段内搜索效率显然要高些。  
  
索引使用和创建：  
1：尽量使用覆盖索引查询，不需要回表查询，减少IO提高效率  
2：使用索引扫描来排序。不然效率极低。  
3：避免创建冗余和重复索引，删除长期未使用的索引  
4：explain后再提测是一种美德，我在初期吃过一次亏，预生产慢查询，img_id 没有索引  

sql优化：  
1：分页优化。覆盖索引扫描出  
2：GROUP BY 和 ORDER BY中的表达式只涉及到一个表中的列，这样MySQL才有可能使用索引来优化  
3：慎用in 和 not in ，避免查询过多导致全表扫描，对于连续的数值，能用 between 就不要用 in 了，很多时候用 exists 代替 in 是一个好的选择；  
4：通配符注意前面不能匹配，不然会全表扫描  
5：表达式左边字段使用函数不能走索引。 eg: where substring(name,1,3) = 'gsm'  name字段不能走索引  
6：索引的话 数字要比字符串更快，在联表查询的时候 合理的外键可以提升很多性能  
7：任何查询都不要用* 只查询你所需要的字段。不要返回无意义的字段  
8：尽量避免大事务操作，提高系统并发能力。在事务里最忌讳做一些复杂操作，不然并发能力很差  


###Mysql 有那些存储引擎，有哪些区别？
1、事务安全：InnoDB支持事务安全，MyISAM和MEMORY两个不支持。  
2、存储限制：InnoDB有64TB的存储限制，MyISAM和MEMORY要是具体情况而定。  
3、空间使用：InnoDB对空间使用程度较高，MyISAM和MEMORY对空间使用程度较低。  
4、内存使用：InnoDB和MEMORY对内存使用程度较高，MyISAM对内存使用程度较低。  
5、插入数据的速度：InnoDB插入数据的速度较低，MyISAM和MEMORY插入数据的速度较高。  
6、对外键的支持：InnoDB对外键支持情况较好，MyISAM和MEMORY两个不支持外键。  

三种引擎特点如下：  
+ InnoDB存储引擎：  
InnoDB是事务型数据库的首选引擎，支持事务安全表（ACID），其它存储引擎都是非事务安全表，支持行锁定、外键，MySQL5.5以后默认使用InnoDB存储引擎。  
InnoDB特点： 支持事务处理，支持外键，支持崩溃修复能力和并发控制。如果需要对事务的完整性要求比较高（比如银行），要求实现并发控制（比如售票），那选择InnoDB有很大的优势。  
如果需要频繁的更新、删除操作的数据库，也可以选择InnoDB，因为支持事务的提交（commit）和回滚（rollback）。  

+ MyISAM存储引擎：  
MyISAM基于ISAM存储引擎，并对其进行扩展。它是在Web、数据仓储和其他应用环境下最常使用的存储引擎之一。  
MyISAM拥有较高的插入、查询速度，但不支持事务，不支持外键。  
MyISAM特点： 插入数据快，空间和内存使用比较低。如果表主要是用于插入新记录和读出记录，那么选择MyISAM能实现处理高效率。如果应用的完整性、并发性要求比较低，也可以使用  

+ MEMORY存储引擎：  
MEMORY存储引擎将表中的数据存储到内存中，为查询和引用其他表数据提供快速访问。  
MEMORY特点： 所有的数据都在内存中，数据的处理速度快，但是安全性不高。如果需要很快的读写速度，对数据的安全性要求较低，可以选择MEMOEY。  
它对表的大小有要求，不能建立太大的表。所以，这类数据库只使用在相对较小的数据库表。  
